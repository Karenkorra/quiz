name: CI - Test QUIZ-APP

on:
  push:
    branches: [ "master" ]
  pull_request:
    branches: [ "master" ]

jobs:
  test-app:
    runs-on: ubuntu-latest

    steps:
      - name: ğŸšš Checkout code
        uses: actions/checkout@v4

      - name: ğŸ›  Setup Docker Buildx
        uses: docker/setup-buildx-action@v3

      - name: ğŸ³ Build and start containers
        run: |
          docker compose down || true
          docker compose build
          docker compose up -d
          sleep 10

      - name: ğŸ§ª Test backend
        run: |
          echo "â¡ï¸ Test backend..."
          curl -f http://localhost:3000/questions

      - name: ğŸ§ª Test frontend
        run: |
          echo "â¡ï¸ Test frontend..."
          curl -f http://localhost:8082

      - name: ğŸ§¹ Cleanup
        run: docker compose down
